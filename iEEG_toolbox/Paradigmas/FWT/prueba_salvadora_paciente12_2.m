clc;
clear all;
close all;

%micromed_time=micromed_time-micromed_time(1,1);
% micromed_time=micromed_time(1,5:end);

micromed_time=[0,0.462890625000000,70.0625000000000,72.1630859375000,72.7802734375000,76.2451171875000,77.6806640625000,78.2626953125000,79.4746093750000,80.0976562500000,81.4140625000000,81.9960937500000,82.8134765625000,83.4482421875000,85.2304687500000,85.8466796875000,87.2968750000000,87.9150390625000,89.0820312500000,89.6640625000000,90.7636718750000,91.3818359375000,92.5322265625000,93.1142578125000,94.8164062500000,129.402343750000,130.486328125000,131.648437500000,132.637695312500,133.771484375000,135.088867187500,136.205078125000,137.453125000000,138.588867187500,140.439453125000,141.555664062500,142.789062500000,143.906250000000,145.189453125000,146.321289062500,146.956054687500,148.089843750000,149.790039062500,150.874023437500,151.921875000000,153.056640625000,154.424804687500,155.524414062500,156.605468750000,157.775390625000,158.574218750000,159.688476562500,160.841796875000,161.975585937500,163.141601562500,164.240234375000,165.475585937500,166.576171875000,167.691406250000,168.826171875000,170.159179687500,171.241210937500,172.626953125000,173.744140625000,175.026367187500,176.126953125000,177.260742187500,178.360351562500,180.143554687500,181.278320312500,182.644531250000,183.708007812500,185.079101562500,186.228515625000,187.792968750000,188.945312500000,190.228515625000,191.329101562500,192.562500000000,193.679687500000,194.563476562500,195.674804687500,197.379882812500,198.496093750000,199.930664062500,201.044921875000,202.377929687500,203.495117187500,204.664062500000,205.761718750000,206.814453125000,207.948242187500,208.814453125000,209.964843750000,211.605468750000,212.730468750000,213.732421875000,214.881835937500,216.096679687500,217.213867187500,218.563476562500,219.714843750000,221.397460937500,222.533203125000,224.033203125000,225.130859375000,226.264648437500,227.416992187500,228.867187500000,229.964843750000,231.116210937500,232.234375000000,233.351562500000,234.467773437500,235.568359375000,236.666015625000,237.485351562500,238.619140625000,239.435546875000,240.568359375000,241.382812500000,242.519531250000,243.645507812500,244.752929687500,245.835937500000,246.936523437500,248.650390625000,249.787109375000,251.017578125000,252.114257812500,253.070312500000,254.118164062500,255.501953125000,256.587890625000,257.721679687500,258.804687500000,259.988281250000,261.071289062500,262.272460937500,263.338867187500,264.019531250000,265.105468750000,266.516601562500,267.605468750000,269.136718750000,270.239257812500,271.073242187500,272.139648437500,273.037109375000,274.104492187500,275.204101562500,276.306640625000,277.673828125000,278.733398437500,280.628906250000,281.705078125000,326.076171875000,327.227539062500,327.813476562500,328.697265625000,329.263671875000,331.078125000000,331.660156250000,332.531250000000,333.065429687500,334.761718750000,335.347656250000,336.431640625000,336.978515625000,338.415039062500,338.961914062500,339.848632812500,340.416015625000,341.449218750000,341.996093750000,343.282226562500,343.829101562500,344.712890625000,345.298828125000,346.229492187500,353.900390625000,354.784179687500,355.867187500000,356.814453125000,357.917968750000,358.714843750000,359.797851562500,361.535156250000,362.598632812500,363.902343750000,364.968750000000,366.202148437500,367.269531250000,368.618164062500,369.666015625000,370.769531250000,371.853515625000,373,374.103515625000,374.903320312500,375.970703125000,377.162109375000,378.237304687500,379.287109375000,380.350585937500,381.354492187500,382.420898437500,383.317382812500,384.401367187500,385.601562500000,386.667968750000,387.535156250000,388.601562500000,389.338867187500,390.405273437500,391.151367187500,392.239257812500,393.552734375000,394.638671875000,395.486328125000,396.588867187500,397.819335937500,398.916015625000,400.073242187500,401.118164062500,402.836914062500,403.923828125000,404.871093750000,405.958007812500,407.340820312500,408.404296875000,409.307617187500,410.354492187500,411.074218750000,412.121093750000,413.058593750000,414.125000000000,415.205078125000,416.289062500000,417.205078125000,418.309570312500,419.759765625000,420.823242187500,421.722656250000,422.789062500000,423.759765625000,424.823242187500,425.976562500000,427.040039062500,428.060546875000,429.127929687500,430.427734375000,431.490234375000,433.745117187500,434.811523437500,435.710937500000,436.794921875000,438.478515625000,439.561523437500,440.857421875000,441.962890625000,443.295898437500,444.363281250000,445.176757812500,446.247070312500,447.196289062500,448.279296875000,449.480468750000,450.551757812500,451.542968750000,452.647460937500,453.831054687500,454.915039062500,456.247070312500,457.314453125000,458.796875000000,459.865234375000,460.898437500000,461.964843750000,463.131835937500,464.212890625000,464.930664062500,466.015625000000,467.449218750000,468.516601562500,469.866210937500,470.912109375000,471.899414062500,472.983398437500,473.949218750000,474.996093750000,476.279296875000,477.383789062500,478.267578125000,479.333984375000,480.201171875000,481.267578125000,482.201171875000,483.263671875000,484.430664062500,485.517578125000,486.167968750000,487.235351562500,488.331054687500,489.435546875000,490.702148437500,491.769531250000,492.767578125000,493.852539062500,494.930664062500,496.019531250000,496.833007812500,509.094726562500;];

a={1212581.30839445,1212583.36801813,1212585.70145310,1212587.90184524,1212589.96867540,1212592.25200496,1212594.31920332,1212597.06949090,1212599.58644230,1212601.58652355,1212603.70353439,1212606.90381877,1212608.95410678,1212610.98774188,1212613.27136950,1212615.70493275,1212617.95485557,1212620.95554277,1212623.20547842,1212625.45597768,1212627.45613761,1212629.55630482,1212631.55655327,1212633.55677778,1212635.87385833,1212638.24079198,1212640.30751695,1212642.54127649,1212645.35821292,1212647.62504864,1212650.05861532,1212652.37572837,1212654.77585666,1212657.24292416,1212660.24311189,1212662.47684193,1212665.86055464,1212668.61069170,1212670.94446663,1212673.34448417,1212675.87834164,1212677.89511728,1212680.07884753,1212682.01219397,1212684.17926875,1212686.39619876,1212688.52958071,1212690.47997819,1212692.39670551,1212695.01366332,1212697.03072078,1212699.29755351,1212701.34783767,1212703.94797879,1212706.41512369,1212708.96523766,1212711.73234878,1212713.91576129,1212716.49942227,1212718.58312386,1212720.54997883,1212723.51683722,1212725.96699780,1212728.35076311,1212731.05118006,1212733.71814236;};
b={1.07376167969778,1.31770574511029,1.20075049716979,1.05073830951005,1.26750796474516,1.06749941199087,1.75084949447773,1.51721867034212,1.00069618760608,1.11730548017658,2.18419252079912,1.05050952546299,1.01748123741709,1.28434988972731,1.41741067799740,1.23388270009309,1.98412281647325,1.23399431235157,1.23419530037791,1.00073681282811,1.10020013269968,1.00075220759027,1.00070602307096,1.30071072722785,1.36731168092228,1.06732750334777,1.23414013558067,1.81748337578028,1.25071906601079,1.43409395101480,1.30075306282379,1.40043148235418,1.46744681312703,2.00084885279648,1.23400329286233,2.36749941203743,1.73417477379553,1.31754238903523,1.38411939516664,1.51751844165847,1.01717034773901,1.16734931268729,0.917338835541159,1.16740062879398,1.21738758566789,1.11742222402245,0.950746434740722,0.917258867993951,1.60051144985482,1.00073039834388,1.26738737197593,1.05074130301364,1.60071243764833,1.46738651674241,1.55103722563945,1.75078962580301,1.18380422936752,1.56715602218173,1.08411383605562,0.950727618765086,1.96747460914776,1.43407385214232,1.38405952672474,1.70074622076936,1.65084607317112,1.03407898382284;};

n={2.56733733881265,1.28403643448837,1.38405140163377,1.81715024914593,1.05033889971673,1.25066817761399,0.967244969913736,1.01725459168665,1.70089033339173,1.30064187827520,1.43378733773716,1.30041010072455,1.01725159818307,1.33392631867901,0.700741516659036,1.76709016668610,0.850781500572339,1.08391712466255,1.13392075966112,1.20066710864194,1.08391626947559,2.41746242158115,1.48387436126359,1.10063845710829,1.51729821017943,0.983734952751547,0.733869870891795,1.21714426227845,1.61757916561328,1.11724047968164,1.15061386814341,1.03385447640903,1.40063845715486,1.61734867119230,1.93411447759718,1.23392375302501,1.05030811019242,1.93387543014251,1.11728024971671,1.18399794725701,1.75041159731336,0.717413671547547,1.23397763469256,1.01726571028121,1.33394000306726,0.850545446854085,1.35063396696933,1.33387799630873,0.950633966829628,1.10059868707322,1.38396074320190,1.05058949301019,1.16746733943000,0.867091877153143,0.867149179801345,1.66704654810019,1.00083260261454,1.10063375323080,1.65065235504881,1.06725694355555,0.784056960837916,1.15061301272362,1.65035429457203,1.21695182705298,1.13370993593708,1.05064722360112;};
m={1213191.12677158,1213194.70286258,1213196.98663260,1213199.38690329,1213202.20389532,1213204.25413244,1213206.50418482,1213208.48781757,1213210.50453933,1213213.20512433,1213215.50536338,1213217.95558297,1213220.25591567,1213222.28946353,1213224.63958306,1213226.33978233,1213229.12344630,1213230.97365263,1213233.05734953,1213235.19090380,1213237.40765935,1213239.49123864,1213242.92511963,1213245.42526759,1213247.52553230,1213250.05918151,1213252.04267100,1213253.77631636,1213255.99314589,1213258.61007890,1213260.72707563,1213262.89401612,1213264.92761872,1213267.32798050,1213269.94465821,1213272.87851312,1213275.11192457,1213277.16217366,1213280.09593876,1213282.21285723,1213284.39642627,1213287.14674122,1213288.86358058,1213291.09714854,1213293.11405717,1213295.44769954,1213297.29791058,1213299.64816224,1213301.99836430,1213303.96518891,1213306.08202228,1213308.48243580,1213310.54919156,1213312.73282260,1213314.59961855,1213316.48329363,1213319.15041844,1213321.15030683,1213323.26739550,1213325.93440741,1213328.01792213,1213329.80133293,1213331.96842053,1213334.61871240,1213336.83546238,1213338.98571960;};

c=cell2mat(a);
d=cell2mat(b);

o=cell2mat(m);
p=cell2mat(n);

o=(o-o(1,1))+353.900390625000;
c=(c-c(1,1))+129.402343750000;

for i=1:length(c)
   
    f(1,i)=c(1,i)+d(1,i);
    q(1,i)=o(1,i)+p(1,i);
end

stimuli_time=horzcat(c,o);
response_time=horzcat(f,q);

for i=1:length(stimuli_time);
    times{1, i} = stimuli_time(1,i);
    times{2, i} = response_time(1,i);
end

save('log_times_paciente12_1', 'times');


plot([micromed_time;micromed_time],[-100;0],'r')
hold on   

plot([f;f],[0;100],'g')
hold on  

plot([c;c],[0;100],'b')
hold on   

plot([q;q],[0;100],'g')
hold on  

plot([o;o],[0;100],'b')
hold on   
 