clc;
clear all;
close all;

%micromed_time=micromed_time-micromed_time(1,1);
% micromed_time=micromed_time(1,5:end);

micromed_time=[0,0.462890625000000,70.0625000000000,72.1630859375000,72.7802734375000,76.2451171875000,77.6806640625000,78.2626953125000,79.4746093750000,80.0976562500000,81.4140625000000,81.9960937500000,82.8134765625000,83.4482421875000,85.2304687500000,85.8466796875000,87.2968750000000,87.9150390625000,89.0820312500000,89.6640625000000,90.7636718750000,91.3818359375000,92.5322265625000,93.1142578125000,94.8164062500000,129.402343750000,130.486328125000,131.648437500000,132.637695312500,133.771484375000,135.088867187500,136.205078125000,137.453125000000,138.588867187500,140.439453125000,141.555664062500,142.789062500000,143.906250000000,145.189453125000,146.321289062500,146.956054687500,148.089843750000,149.790039062500,150.874023437500,151.921875000000,153.056640625000,154.424804687500,155.524414062500,156.605468750000,157.775390625000,158.574218750000,159.688476562500,160.841796875000,161.975585937500,163.141601562500,164.240234375000,165.475585937500,166.576171875000,167.691406250000,168.826171875000,170.159179687500,171.241210937500,172.626953125000,173.744140625000,175.026367187500,176.126953125000,177.260742187500,178.360351562500,180.143554687500,181.278320312500,182.644531250000,183.708007812500,185.079101562500,186.228515625000,187.792968750000,188.945312500000,190.228515625000,191.329101562500,192.562500000000,193.679687500000,194.563476562500,195.674804687500,197.379882812500,198.496093750000,199.930664062500,201.044921875000,202.377929687500,203.495117187500,204.664062500000,205.761718750000,206.814453125000,207.948242187500,208.814453125000,209.964843750000,211.605468750000,212.730468750000,213.732421875000,214.881835937500,216.096679687500,217.213867187500,218.563476562500,219.714843750000,221.397460937500,222.533203125000,224.033203125000,225.130859375000,226.264648437500,227.416992187500,228.867187500000,229.964843750000,231.116210937500,232.234375000000,233.351562500000,234.467773437500,235.568359375000,236.666015625000,237.485351562500,238.619140625000,239.435546875000,240.568359375000,241.382812500000,242.519531250000,243.645507812500,244.752929687500,245.835937500000,246.936523437500,248.650390625000,249.787109375000,251.017578125000,252.114257812500,253.070312500000,254.118164062500,255.501953125000,256.587890625000,257.721679687500,258.804687500000,259.988281250000,261.071289062500,262.272460937500,263.338867187500,264.019531250000,265.105468750000,266.516601562500,267.605468750000,269.136718750000,270.239257812500,271.073242187500,272.139648437500,273.037109375000,274.104492187500,275.204101562500,276.306640625000,277.673828125000,278.733398437500,280.628906250000,281.705078125000,326.076171875000,327.227539062500,327.813476562500,328.697265625000,329.263671875000,331.078125000000,331.660156250000,332.531250000000,333.065429687500,334.761718750000,335.347656250000,336.431640625000,336.978515625000,338.415039062500,338.961914062500,339.848632812500,340.416015625000,341.449218750000,341.996093750000,343.282226562500,343.829101562500,344.712890625000,345.298828125000,346.229492187500,353.900390625000,354.784179687500,355.867187500000,356.814453125000,357.917968750000,358.714843750000,359.797851562500,361.535156250000,362.598632812500,363.902343750000,364.968750000000,366.202148437500,367.269531250000,368.618164062500,369.666015625000,370.769531250000,371.853515625000,373,374.103515625000,374.903320312500,375.970703125000,377.162109375000,378.237304687500,379.287109375000,380.350585937500,381.354492187500,382.420898437500,383.317382812500,384.401367187500,385.601562500000,386.667968750000,387.535156250000,388.601562500000,389.338867187500,390.405273437500,391.151367187500,392.239257812500,393.552734375000,394.638671875000,395.486328125000,396.588867187500,397.819335937500,398.916015625000,400.073242187500,401.118164062500,402.836914062500,403.923828125000,404.871093750000,405.958007812500,407.340820312500,408.404296875000,409.307617187500,410.354492187500,411.074218750000,412.121093750000,413.058593750000,414.125000000000,415.205078125000,416.289062500000,417.205078125000,418.309570312500,419.759765625000,420.823242187500,421.722656250000,422.789062500000,423.759765625000,424.823242187500,425.976562500000,427.040039062500,428.060546875000,429.127929687500,430.427734375000,431.490234375000,433.745117187500,434.811523437500,435.710937500000,436.794921875000,438.478515625000,439.561523437500,440.857421875000,441.962890625000,443.295898437500,444.363281250000,445.176757812500,446.247070312500,447.196289062500,448.279296875000,449.480468750000,450.551757812500,451.542968750000,452.647460937500,453.831054687500,454.915039062500,456.247070312500,457.314453125000,458.796875000000,459.865234375000,460.898437500000,461.964843750000,463.131835937500,464.212890625000,464.930664062500,466.015625000000,467.449218750000,468.516601562500,469.866210937500,470.912109375000,471.899414062500,472.983398437500,473.949218750000,474.996093750000,476.279296875000,477.383789062500,478.267578125000,479.333984375000,480.201171875000,481.267578125000,482.201171875000,483.263671875000,484.430664062500,485.517578125000,486.167968750000,487.235351562500,488.331054687500,489.435546875000,490.702148437500,491.769531250000,492.767578125000,493.852539062500,494.930664062500,496.019531250000,496.833007812500,509.094726562500;];

a={1206725.45277598,1206727.69545896,1206729.79558254,1206732.22930018,1206734.61294020,1206737.58000171,1206739.93017169,1206742.34711711,1206744.09726400,1206746.89755821,1206749.08118497,1206751.54818277,1206753.78156086,1206755.71501593,1206757.99893263,1206760.29914259,1206762.61596485,1206764.83297911,1206767.29992003,1206769.76674165,1206772.15048857,1206774.38393038,1206777.26757895,1206779.73450918,1206782.20147363,1206784.93508905,1206787.33536830,1206789.65225384,1206791.65248049,1206794.46955163,1206797.01979217,1206799.48671599,1206801.77030383,1206803.93720798,1206805.93756249,1206808.73790930,1206810.83812696,1206813.20492292,1206815.67205585,1206818.48888110,1206821.12260771,1206823.38954222,1206825.97316898,1206828.23987257,1206830.47359276,1206832.69062627,1206834.62401548,1206836.55756420,1206838.50781501,1206840.75804101,1206842.95842289,1206845.80860100,1206848.14211123,1206850.15916398,1206852.62615964,1206854.84307041,1206857.10998867,1206859.39357566,1206861.16044645,1206863.66064530,1206866.29435053,1206868.19449978,1206870.17808164,1206872.36169129,1206874.81193782,1206877.77874532;};
b={1.25336624425836,1.08380212937482,1.43391718482599,1.38400991773233,1.95014960848494,1.35065259400290,1.40044739289442,0.750552185112611,1.80029652285157,1.16706201620400,1.46669891040074,1.21712109417422,0.933586835977621,1.26691931404639,1.28390159754781,1.31716398603749,1.21719379228307,1.45039400248788,1.46731299581006,1.38379267859273,1.23378051235341,1.88386815640843,1.46677417436149,1.45064930123044,1.71733170491643,1.40037512237905,1.31673720525578,1.00073254061863,1.80051034083590,1.55035991990007,1.46698200551327,1.26707454596180,1.15042611799436,0.983714763307944,1.78382269869326,1.10063302965136,1.35043749312172,1.45044574647909,1.81738486007089,1.61727555631660,1.25057207013015,1.56694792292546,1.25047499674838,1.23383995378390,1.21695175027708,0.917058274440933,0.933713843929581,0.950275761133526,1.25062082067598,1.18373426352628,1.83379368355963,1.33353688806528,1.01739495230140,1.45050818129675,1.20050786057254,1.25044463464292,1.26730546943145,0.767101273173466,1.50046633713646,1.61710792296799,0.900507048063446,0.983724171295762,1.16687813267345,1.43396422482329,1.95034033420961,3.00124527624575;};

n={0.966755144530907,1.03374561731471,0.883691115071997,1.78380388271762,1.35048196726711,1.30039466533344,1.41685920982854,1.15043467067881,1.23391650064150,0.867075743328314,1.26728451525560,1.11707050475525,1.05053460923955,0.983870422816835,1.26711987535236,0.933726672956254,0.783696973638143,0.833729965786915,1.40029301622417,0.933742067893036,1.31695872073760,1.21722843078896,1.78375042817788,1.03380933502922,1.45045943080913,0.950620435760357,0.767062358325347,0.983860159583855,1.16706244385568,0.983699368429370,1.51726687524933,0.967036956746597,1.01707251468906,1.20048690639669,1.06711577007081,1.36721664940706,2.30057940410916,0.967095115222037,1.75026353070280,1.38400008209283,1.40043456375133,0.883535883156583,1.01725853636162,1.26708395394962,1.06684208294610,1.25035867973929,1.40039522125153,1.55047965794802,1.10048463998828,1.23396225768374,0.783939015702345,1.50023242022144,1.41705677768914,1.03369814966572,1.03374433435965,1.35027456370881,0.950406617717817,0.933701442496385,1.00038187898463,1.23395798134152,0.717038774222601,1.18384416599292,1.33377550903242,1.06705504574347,1.16729336726712,0.883711213944480;};
m={1207167.63555731,1207169.61166585,1207171.64520730,1207173.54552802,1207176.32909192,1207178.67936240,1207180.97959973,1207183.39653531,1207185.56346854,1207187.79701939,1207189.66391370,1207191.93078150,1207194.04770981,1207196.09783959,1207198.08151254,1207200.34846159,1207202.29853664,1207204.09880348,1207205.93235134,1207208.33265325,1207210.26624645,1207212.58314311,1207214.80005431,1207217.58362804,1207219.61726870,1207222.06754346,1207224.01776818,1207225.80131497,1207227.80138767,1207229.98507259,1207231.98518848,1207234.51880562,1207236.48560671,1207238.51938891,1207240.73630952,1207242.80319742,1207245.18676688,1207248.48708033,1207250.45398662,1207253.22103616,1207255.60462956,1207258.00495243,1207259.90512861,1207261.92200346,1207264.20538177,1207266.28918985,1207268.53930167,1207270.95634929,1207273.50663901,1207275.62353910,1207277.87367059,1207279.67397977,1207282.17413543,1207284.60788385,1207286.64132139,1207288.67486284,1207291.02526631,1207292.97535889,1207294.90904146,1207296.90919840,1207299.14282751,1207300.87635400,1207303.07661186,1207305.41021104,1207307.47710406,1207309.64395946;};

c=cell2mat(a);
d=cell2mat(b);

o=cell2mat(m);
p=cell2mat(n);

o=(o-o(1,1))+353.900390625000;
c=(c-c(1,1))+129.402343750000;

for i=1:length(c)
   
    f(1,i)=c(1,i)+d(1,i);
    q(1,i)=o(1,i)+p(1,i);
end

stimuli_time=horzcat(c,o);
response_time=horzcat(f,q);

for i=1:length(stimuli_time);
    times{1, i} = stimuli_time(1,i);
    times{2, i} = response_time(1,i);
end

save('log_times_paciente12_1', 'times');


plot([micromed_time;micromed_time],[-100;0],'r')
hold on   

plot([f;f],[0;100],'g')
hold on  

plot([c;c],[0;100],'b')
hold on   

plot([q;q],[0;100],'g')
hold on  

plot([o;o],[0;100],'b')
hold on   
 